<!DOCTYPE html>
<html lang="en"
	  xmlns="http://www.w3.org/1999/xhtml"
	  xmlns:faces="jakarta.faces"
      xmlns:h="jakarta.faces.html"
      xmlns:f="jakarta.faces.core"
      xmlns:p="http://primefaces.org/ui"
      xmlns:ui="jakarta.faces.facelets"
      xmlns:pt="jakarta.faces.passthrough"
      xmlns:cc="jakarta.faces.composite"
      xmlns:c="jakarta.tags.core"
    xmlns:fn="jakarta.tags.functions"
    xmlns:my="jakarta.faces.component"
    >

<h:head>
	<link rel="shortcut icon" type="image/x-icon" href="#{resource['favicon.ico']}" />
	<title>Collector's Recording</title>
	<f:facet name="middle">
           <h:outputStylesheet name="bootstrap/css/bootstrap.min.css"/>
            <h:outputStylesheet name="css/pageHeaderFooter.css"/>
            <h:outputStylesheet name="css/growl.css"/>
             <h:outputStylesheet name="css/bodyconf.css"/>
             <h:outputStylesheet library="webjars" name="primeflex/3.3.0/primeflex.min.css" />
            <h:outputScript name="jquery/jquery.min.js" target="head"/>
            <h:outputScript name="bootstrap/js/bootstrap.min.js" target="head"/>
    </f:facet>
    
<style>
<!-- 
	
 -->
 </style>

</h:head>

<h:body>

<h:form prependId="false" id="formId">
	<ui:include src="header.xhtml" />
	
	<p:growl id="msg" showDetail="true" life="2000" />
	<p:confirmDialog global="true" showEffect="fade" hideEffect="fade" responsive="true" width="350">
            <p:commandButton value="No" type="button" styleClass="ui-confirmdialog-no ui-button-flat"/>
            <p:commandButton value="Yes" type="button" styleClass="ui-confirmdialog-yes" />
        </p:confirmDialog>
    
    <p:confirmPopup global="true">
            <p:commandButton value="No" type="button" styleClass="ui-confirm-popup-no ui-button-flat"/>
            <p:commandButton value="Yes" type="button" styleClass="ui-confirm-popup-yes" />
    </p:confirmPopup>
    	 	 
	
	<div class="card">
    
	    <div class="grid">
	    	
	    	
		    	<div class="col-7">
		    		<div class="grid">
		    		
		    		<div class="col-12">
		    			<p:toolbar id="tbForm">
			    		<f:facet name="left">
			    				<div class="ui-inputgroup">
			    				<p:commandButton value="Form Series History" onclick="PF('dlgCSeries').show()"/>
			    				<p:commandButton value="Show Income Per Forms" actionListener="#{logformBean.loadFormDetails}" update="tbFormPer formData"/>
			    				<p:commandButton value="Create Bank Deposit" actionListener="#{bankdp.openBankTransaction}" update="depositId"/>
			    				<p:commandButton value="Cash Ticket Movement" update="dataCashId" oncomplete="PF('dlgMovement').show()"/>
			    				</div>
			    		</f:facet>
			    		<f:facet name="right">
			    			<div class="ui-inputgroup">
			    			<p:commandButton update="gridId listForm" value="New" icon="pi pi-file-o" actionListener="#{logformBean.clear}">
			    				<p:confirm type="popup" header="Confirmation" message="Are you sure you want to create new?" icon="pi pi-info-circle" />
			    			</p:commandButton>
			    			<p:commandButton update="gridId listForm" value="Clear" icon="pi pi-trash" action="#{logformBean.clear}">
			    				<p:confirm type="popup" header="Confirmation" message="Are you sure you want clear all fields?" icon="pi pi-info-circle" />
			    			</p:commandButton>
			    			</div>
			    		</f:facet>
						</p:toolbar> 
		    		</div>
		    		<div class="col-12">
		    			
						<p:panelGrid id="gridId" columns="4" layout="grid">
			
							<p:outputLabel value="Received Date"/>
							<p:calendar value="#{logformBean.receivedDate}" pattern="yyyy-MM-dd" effect="slideDown" disabledWeekends="true" inputStyle="width: 12em"/>
								
							<p:outputLabel value="Is RTS?"/>
							<p:selectOneMenu id="isRtsId" value="#{logformBean.rtsId}" style="width: 12em" disabled="false">
									<f:selectItems value="#{logformBean.rts}"/>
							</p:selectOneMenu>
							
							<p:outputLabel value="Fund"/>	
						    <p:selectOneMenu id="fundId" value="#{logformBean.fundId}" style="width: 12em" disabled="false">
									<f:selectItems value="#{logformBean.funds}"/>
									<p:ajax event="change" listener="#{logformBean.loadIssuedForm}" update="seriesId fromId endId frmId qtyId listForm grpId"/>
							</p:selectOneMenu>
								
								<p:outputLabel value="Collector"/>	
							    <p:selectOneMenu id="colId" value="#{logformBean.collectorId}" style="width: 12em" filter="true" filterMatchMode="contains">
										<f:selectItems value="#{logformBean.collectors}"/>
										<p:ajax event="change" listener="#{logformBean.loadIssuedForm}" update="seriesId fromId endId frmId qtyId listForm grpId"/>
								</p:selectOneMenu>
								
								<p:outputLabel value="Serial Issued"/>	
							    <p:selectOneMenu id="seriesId" value="#{logformBean.issuedId}" style="width: 12em" filter="true" filterMatchMode="contains">
										<f:selectItems value="#{logformBean.issueds}"/>
										<p:ajax event="change" listener="#{logformBean.loadLatestSeries}" update="fromId endId frmId qtyId"/>
								</p:selectOneMenu>
								
								<p:outputLabel value="Quantity"/>
								<p:inputText id="qtyId" value="#{logformBean.quantity}" style="width: 12em">
									<p:ajax event="keyup" listener="#{logformBean.calculateEndingNo}" update="fromId endId amntId msg" />
								</p:inputText>
								
								<p:outputLabel value="From Serial"/>
								<p:inputText id="fromId" value="#{logformBean.beginningNo}" style="width: 12em">
									<p:ajax event="keyup" listener="#{logformBean.calculateEndingNo}" update="endId" />
								</p:inputText>
								
								<p:outputLabel value="To Serial"/>
								<p:inputText id="endId" value="#{logformBean.endingNo}" style="width: 12em"/>
								
								<p:outputLabel value="Form Type"/>	
							    <p:selectOneMenu id="frmId" value="#{logformBean.formTypeId}" style="width: 12em" disabled="true">
										<f:selectItems value="#{logformBean.formTypes}"/>
								</p:selectOneMenu>
								
								<p:outputLabel value="Amount"/>
								<p:inputNumber id="amntId" value="#{logformBean.amount}" inputStyle="width: 12em"/>
								
								<p:outputLabel value="Group Report Code"/>
								<p:inputText id="grpId" value="#{logformBean.group}" style="width: 12em"/>
								
								<p:outputLabel value="Action"/>	
								<p:commandButton update="listForm gridId tbFormNew saveNormalId saveNotNormalId isRtsId msg" value="Add to List" icon="fa fa-file-o" actionListener="#{logformBean.addGroup}"/>
								
						</p:panelGrid>

		    		</div>
		    		
		    		<div class="col-12">
	    			<p:toolbar id="tbFormNew">
		    		<f:facet name="left">
		    			<p:commandButton update="gridId listForm tbFormNew msg" value="Clear Below List" icon="pi pi-trash" action="#{logformBean.clearBelowFormList}">
		    				<p:confirm type="popup" header="Confirmation" message="Are you sure you want clear below forms list?" icon="pi pi-info-circle" />
		    			</p:commandButton>	
		    		</f:facet>
		    		<f:facet name="right">
		    			<p:outputLabel value="Php#{logformBean.totalAmount}" style="font-weight: bold; font-size: 2em"/>
		    		</f:facet>
					</p:toolbar>
	    		</div>
	    		
	    		<div class="col-12">
	    			<p:dataTable id="listForm" value="#{logformBean.newForms}" var="rp" stickyHeader="false"
							rows="13" paginator="true" paginatorTemplate="{CurrentPageReport} {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                         rowsPerPageTemplate="26,50,100" lazy="false"
                         scrollable="true" paginatorPosition="top" editable="#{logformBean.currentDate}" editMode="cell" reflow="true">
                         	
                         	<p:ajax event="cellEdit"  listener="#{logformBean.onCellEdit}" update="listForm,reportData,tbFormGen,msg" />
                         	
                         	<p:column headerText="[*]" width="20" exportable="false">
            					<p:commandButton update="tbFormNew listForm gridId reportData msg" icon="pi pi-trash" actionListener="#{logformBean.deleteRow(rp)}">
            						<p:confirm header="Confirmation" message="Are you sure you want to delete this data?" icon="ui-icon-alert" />
            					</p:commandButton>
            				</p:column>
            				
            				
                         	<p:column headerText="AF Form" width="100">
            						<p:outputLabel value="#{rp.formTypeName}"/>
            				</p:column>
            				
            				<p:column headerText="From Serial" width="50">
            						<p:outputLabel value="#{rp.startNo}"/>
            				</p:column>
            				
            				<p:column headerText="To Serial" width="50">
            						<p:outputLabel value="#{rp.endNo}"/>
            				</p:column>
            				
            				<p:column headerText="Qty" width="20">
            						<p:outputLabel value="#{rp.pcs}"/>
            				</p:column>
            				
            				<p:column headerText="Amount" width="30">
            						<p:cellEditor>
            							<f:facet name="output"><h:outputText value="#{rp.amount}" /></f:facet>
            							<f:facet name="input">
            								<p:inputText value="#{rp.amount}"/>
            							</f:facet>
            						</p:cellEditor>
            				</p:column>	
                         
            		</p:dataTable> 
	    		</div>
	    		
	    		<div class="col-12">
	    			<p:toolbar id="tbFormNew2">
		    		<f:facet name="left">
		    				
		    		</f:facet>
		    		<f:facet name="right">
		    			<div class="ui-inputgroup">
		    			<p:commandButton id="saveNormalId" update="gridId listForm reportData colMapId fundSerId msg" value="Save Only" icon="pi pi-save" actionListener="#{logformBean.saveData}">
		    				<p:confirm type="popup" header="Confirmation" message="Are you sure you want to save this data? Once saved, previous report is no longer allowed for editing." icon="pi pi-info-circle" />
		    			</p:commandButton>
		    			<p:commandButton id="saveNotNormalId" update="ctDtlsId" value="Save With Ticket" onclick="PF('dlgCash').show()"/>
		    			</div>
		    		</f:facet>
					</p:toolbar>
	    		</div>
		    		
		    		</div>
	    		</div>
	    	
	    	<div class="col-5">
	    		
	    		<div class="grid">
	    		
	    		<div class="col-12">
	    			<p:toolbar id="tbFormGen">
		    		<f:facet name="left">
		    					<div class="ui-inputgroup">
		    					<p:selectOneMenu id="fundSerId" value="#{logformBean.fundSearchId}" style="width: 15em" disabled="false">
									<f:selectItems value="#{logformBean.fundsSearch}"/>
									<p:ajax event="change" listener="#{logformBean.init}" update="reportData"/>
								</p:selectOneMenu>
		    					<p:selectOneMenu id="colMapId" value="#{logformBean.collectorMapId}" style="width: 15em" filter="true" filterMatchMode="contains">
									<f:selectItems value="#{logformBean.collectorsMap}"/>
									<p:ajax event="change" listener="#{logformBean.init}" update="reportData"/>
								</p:selectOneMenu>
								<p:calendar value="#{logformBean.dateFrom}" pattern="yyyy-MM-dd" effect="slideDown" inputStyle="width: 7em"/>
				    			<p:calendar value="#{logformBean.dateTo}" pattern="yyyy-MM-dd" effect="slideDown" inputStyle="width: 7em"/>	
				    			<p:commandButton id="findId" update="reportData listForm gridId"  icon="pi pi-search" actionListener="#{logformBean.find}"/>
				    			</div>
		    		</f:facet>
		    		<f:facet name="right"/>
					</p:toolbar> 
	    		</div>
	    		
	    		<div class="col-12">
	    			<p:dataTable id="reportData" value="#{logformBean.infos}" var="in" stickyHeader="false"
							rows="10" paginator="true" paginatorTemplate="{Exporters} {CurrentPageReport} {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                         rowsPerPageTemplate="10,20,30,40,50,100" lazy="false"
                         scrollable="true" paginatorPosition="top" selection="#{logformBean.selectedCollection}" rowKey="#{in.id}">
                       
                       
                       <f:facet name="{Exporters}">
                       				<div class="ui-inputgroup">
                         			<p:menuButton id="exiD" value="Click here for the Report Generation" style="float: left">
                         				<p:menuitem value="Create RCD"  ajax="false" immediate="false" icon="fa fa-file-pdf-o" update="msg" actionListener="#{logformBean.createRCDALL}" target="_blank"/>
                         				<p:menuitem value="View RCD" onclick="PF('dlgPrintAllRCD').show()" icon="fa fa-file" update="formDataAll" actionListener="#{logformBean.viewRCDAll}"/>
                         				<p:menuitem value="Create Daily Summary"  ajax="false" immediate="false" icon="fa fa-file-pdf-o" update="msg" actionListener="#{logformBean.createRCDSum}" target="_blank"/>
                         				<p:menuitem value="View Daily Summary" onclick="PF('dlgPrintSumRCD').show()" icon="fa fa-file" update="formDataSum" actionListener="#{logformBean.viewRCDSum}"/>
                         				<p:menuitem value="Create/View Deposit" onclick="PF('dlgDeposit').show()" icon="fa fa-file" update="formDeps" actionListener="#{logformBean.viewDeposit}"/>
                         				<p:menuitem value="Monthly Summary" ajax="false" immediate="true" icon="fa fa-file-pdf-o" actionListener="#{logformBean.printInternalCollectorSummary('collector')}" target="_blank"/>
										<p:menuitem value="Monthly Collection" ajax="false" immediate="true" icon="fa fa-file-pdf-o" actionListener="#{logformBean.printInternalCollectorSummary('all')}" target="_blank"/>
										<p:menuitem value="Export Excel" ajax="false" immediate="true" icon="pi pi-file-excel">
												<p:dataExporter type="xls" target="reportData" fileName="collection"/> 
										</p:menuitem>
									</p:menuButton>
									</div>
            				</f:facet>
                         	
                      
                         	
                         	<p:column selectionMode="multiple" width="10"/>
                         	
                         	<p:column headerText="Edit" width="30" exportable="false">
								<p:commandButton icon="pi pi-pencil" update="gridId listForm tbFormNew" actionListener="#{logformBean.clickItem(in)}"/>
							</p:column>
                         	
                         	<p:column headerText="PDF" width="30" exportable="false">
								<p:commandLink title="Print in PDF"  actionListener="#{logformBean.printDateModify(in)}" oncomplete="PF('dlgPrint').show();" update="idPrintDate printId printId1 printId2">
            				 			<i class="pi pi-file-pdf" style="font-size: 2rem;float: left; #{in.color}"></i>
								</p:commandLink>
							</p:column>
                         	
                         	<p:column headerText="Forms" width="40" exportable="false" rendered="#{logformBean.userAccess}">
                         		<p:commandButton icon="pi pi-pencil" actionListener="#{formChange.loadFormDetails(in)}" update="collId repId funderId totId"/>
                         	</p:column>
                         	
                         	<p:column headerText="Created" width="70">
            						<p:outputLabel value="#{in.receivedDate}" />
            				</p:column>
                         	
                         	<p:column headerText="Report No" width="70">
            						<p:outputLabel value="#{in.rptFormat}"/>
            				</p:column>
            				
            				<p:column headerText="Collector" width="200">
            						<p:outputLabel value="#{in.collector.name}"/>
            				</p:column>
            				
            				<p:column headerText="Fund" width="120">
            						<p:outputLabel value="#{in.fundName}"/>
            				</p:column>
            				
            				<p:column headerText="Total Amount" width="70">
            						<p:outputLabel value="#{in.amount}" style="font-weight: bold;font-size: 120%">
            							<f:convertNumber currencySymbol="" type="currency"/>
            						</p:outputLabel>
            				</p:column>
            					
                         
            			</p:dataTable> 
	    		</div>
	    		
	    		</div>
	    		
	    	</div>
	
		</div><!-- main grid -->
	</div><!-- Card -->
	
	
	<p:contextMenu for="formDeps">
            <p:menuitem value="Refresh" update="formDeps" icon="pi pi-refresh"
                        actionListener="#{logformBean.viewDeposit}"/>
            <p:menuitem value="Delete" update="formDeps" icon="pi pi-times"
                        action="#{logformBean.deleteDeposit}"/>
    </p:contextMenu>
	
	<p:dialog widgetVar="dlgDeposit" width="1000" position="center top" height="700" header="Deposit Transaction" closeOnEscape="true" closable="true">
		
		<p:dataTable id="formDeps" value="#{logformBean.depTrans}" var="rn" stickyHeader="false"
							rows="10" paginator="true" paginatorTemplate="{Exporters} {CurrentPageReport} {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                         rowsPerPageTemplate="10,20,30,40,50,100" lazy="false"
                         scrollable="true" paginatorPosition="top" paginatorAlwaysVisible="true" rowKey="#{rpt.id}" editable="true"  editMode="cell" draggableRows="true">
                        
                        <f:facet name="{Exporters}">
                        	<div class="ui-inputgroup">
                        	<p:selectOneMenu value="#{logformBean.depositFundTypeId}" style="width: 15em; float: left">
									<f:selectItems value="#{logformBean.depositFundTypes}"/>
									<p:ajax event="change" listener="#{logformBean.viewDeposit}" update="formDeps"/>
							</p:selectOneMenu>
	                        <p:selectOneMenu value="#{logformBean.yearDepositId}" style="width: 15em; float: left">
									<f:selectItems value="#{logformBean.yearDeposits}"/>
									<p:ajax event="change" listener="#{logformBean.viewDeposit}" update="formDeps"/>
							</p:selectOneMenu>
							<p:selectOneMenu value="#{logformBean.monthDepositId}" style="width: 15em; float: left">
									<f:selectItems value="#{logformBean.monthDeposits}"/>
									<p:ajax event="change" listener="#{logformBean.viewDeposit}" update="formDeps"/>
							</p:selectOneMenu>
							
							<p:menuButton id="exeRcd" value="Exports" style="float: right">
										<p:menuitem value="Download Excel" ajax="false" immediate="true" icon="pi pi-file-excel" target="_blank">
											<p:dataExporter type="xls" target="formDeps" fileName="DepositTransaction" pageOnly="false"/>
										</p:menuitem>
										<p:menuitem value="Print Report" ajax="false" immediate="true" icon="pi pi-file-pdf" actionListener="#{logformBean.printCashInTreasury}" target="_blank"/>
									</p:menuButton>
							</div>
							
							
                        </f:facet>
                        
                        <p:ajax event="rowReorder" listener="#{logformBean.onRowReorder}" update="formDeps"/>
                        <p:ajax event="cellEdit"  listener="#{logformBean.onCellEditDeposit}" update="formDeps msg" />	
                         
            			 <p:column headerText="Date" width="50" >
	            			<p:cellEditor>
							<f:facet name="output"><p:outputLabel value="#{rn.day}"/></f:facet>
							<f:facet name="input">
								<p:inputText  value="#{rn.day}" disabled="#{rn.particular.equalsIgnoreCase('RCD-COLLECTION')}" />
							</f:facet>
							</p:cellEditor>
						</p:column>
						
						<p:column headerText="Particular" width="100" >
	            			<p:cellEditor>
							<f:facet name="output"><p:outputLabel value="#{rn.particular}"/></f:facet>
							<f:facet name="input">
								<p:inputText  value="#{rn.particular}" disabled="#{rn.particular.equalsIgnoreCase('RCD-COLLECTION')}"/>
							</f:facet>
							</p:cellEditor>
						</p:column>
            			 
                         <p:column headerText="Reference" width="100" >
            				<p:cellEditor>
								<f:facet name="output"><p:outputLabel value="#{rn.reference}"/></f:facet>
								<f:facet name="input">
									<p:inputText  value="#{rn.reference}" disabled="#{rn.particular.equalsIgnoreCase('RCD-COLLECTION')}"/>
								</f:facet>
							</p:cellEditor>
            			 </p:column>
            			 
            			 <p:column headerText="Debit" width="70" >
            						
            						<p:cellEditor>
									<f:facet name="output">
										<p:outputLabel value="#{rn.debit}">
            								<f:convertNumber currencySymbol="" type="currency"/>
            							</p:outputLabel>
									</f:facet>
									<f:facet name="input">
										<p:inputText  value="#{rn.debit}" disabled="#{rn.particular.equalsIgnoreCase('RCD-COLLECTION')}"/>
									</f:facet>
									</p:cellEditor>
            						
            			 </p:column>
            			 
            			 <p:column headerText="Credit" width="70" >
            						
            						<p:cellEditor>
									<f:facet name="output">
										<p:outputLabel value="#{rn.credit}">
            								<f:convertNumber currencySymbol="" type="currency"/>
            							</p:outputLabel>
									</f:facet>
									<f:facet name="input">
										<p:inputText  value="#{rn.credit}" disabled="#{rn.particular.equalsIgnoreCase('RCD-COLLECTION')}"/>
									</f:facet>
									</p:cellEditor>
            						
            			 </p:column>
            			 
            			 <p:column headerText="Balance" width="70" >
            						<p:outputLabel value="#{rn.balance}">
            							<f:convertNumber currencySymbol="" type="currency"/>
            						</p:outputLabel>
            			 </p:column>
            			 
            			 <p:column headerText="" width="20" exportable="false">
            			 	<p:commandButton icon="pi pi-trash" title="Delete" actionListener="#{logformBean.deleteDeposit(rn)}" update="formDeps msg">
            					<p:confirm header="Confirmation" message="Are you sure you want to delete this data?" icon="ui-icon-alert" />
            				</p:commandButton>
            			 </p:column>
            			 
            			 <p:column headerText="" width="20" exportable="false">
            			 	<p:commandButton icon="pi pi-refresh" title="Refresh" actionListener="#{logformBean.viewDeposit}" update="formDeps msg"/>
            			 </p:column>
                         
                      
        </p:dataTable>    
		
	</p:dialog>
	
	
	<p:dialog widgetVar="dlgPrintAllRCD" width="1000" position="center top" height="700" header="All Revenue Collection" closeOnEscape="true" closable="true">
		
		<p:dataTable id="formDataAll" value="#{logformBean.rcdAll}" var="rn" stickyHeader="false"
							rows="5" paginator="true" paginatorTemplate="{Exporters} {CurrentPageReport} {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                         rowsPerPageTemplate="5,10,20,30,40,50,100" lazy="false"
                         scrollable="true" paginatorPosition="top" paginatorAlwaysVisible="true" rowKey="#{rpt.id}" editable="true"  editMode="cell">
                        
                        <f:facet name="{Exporters}">
                        <p:selectOneMenu value="#{logformBean.rcdAllFundTypeId}" style="width: 15em; float: left">
								<f:selectItems value="#{logformBean.rcdAllFundTypes}"/>
								<p:ajax event="change" listener="#{logformBean.viewRCDAll}" update="formDataAll"/>
						</p:selectOneMenu>
                        </f:facet>
                        
                        <p:ajax event="cellEdit"  listener="#{logformBean.onCellEditRcdAll}" update="msg" />	
                        
                         <p:column headerText="" width="15" exportable="false">
            				 	<p:commandLink title="Print" target="_blank" action="#{logformBean.printRCDAll(rn)}" ajax="false" immediate="false">
            				 			<i class="pi pi-print" style="font-size: 2rem;float: left"></i>
								</p:commandLink>
						 </p:column> 
						 
						 <p:column headerText="" width="15" exportable="false">
            					<p:commandButton icon="pi pi-trash" title="Delete" actionListener="#{logformBean.deleteRCDAll(rn)}" update="formDataAll msg">
            						<p:confirm header="Confirmation" message="Are you sure you want to delete this data?" icon="ui-icon-alert" />
            					</p:commandButton>
            			 </p:column>
                         
            			 <p:column headerText="Date" width="50" >
	            			<p:cellEditor>
							<f:facet name="output"><p:outputLabel value="#{rn.dateTrans}"/></f:facet>
							<f:facet name="input">
								<p:inputText  value="#{rn.dateTrans}"/>
							</f:facet>
							</p:cellEditor>
						</p:column>
						
						<p:column headerText="Series" width="50" >
	            			<p:cellEditor>
							<f:facet name="output"><p:outputLabel value="#{rn.controlNumber}"/></f:facet>
							<f:facet name="input">
								<p:inputText  value="#{rn.controlNumber}"/>
							</f:facet>
							</p:cellEditor>
						</p:column>
            			 
            			 <p:column headerText="Fund" width="70" >
            						<p:outputLabel value="#{rn.fundName}"/>
            			 </p:column>
                         
            			 <p:column headerText="Amount" width="70" >
            			 	<p:cellEditor>
							<f:facet name="output">
            						<p:outputLabel value="#{rn.amount}">
            							<f:convertNumber currencySymbol="" type="currency"/>
            						</p:outputLabel>
            				</f:facet>
            				<f:facet name="input">
								<p:inputNumber  value="#{rn.amount}"/>
							</f:facet>
							</p:cellEditor>
            			 </p:column>
                         
                      
        </p:dataTable>    
		
	</p:dialog>
	
	
	<p:dialog widgetVar="dlgPrintSumRCD" width="1000" position="center top" height="700" header="Daily Summary Revenue Collection" closeOnEscape="true" closable="true">
	
		<p:dataTable id="formDataSum" value="#{logformBean.rcdSum}" var="rn" stickyHeader="false"
							rows="5" paginator="true" paginatorTemplate="{Exporters} {CurrentPageReport} {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                         rowsPerPageTemplate="5,10,20,30,40,50,100" lazy="false"
                         scrollable="true" paginatorPosition="top" paginatorAlwaysVisible="true" rowKey="#{rpt.id}" editable="true"  editMode="cell">
                        
                        <f:facet name="{Exporters}">
                        <p:selectOneMenu value="#{logformBean.rcdSumFundTypeId}" style="width: 15em; float: left">
								<f:selectItems value="#{logformBean.rcdSumFundTypes}"/>
								<p:ajax event="change" listener="#{logformBean.viewRCDSum}" update="formDataSum"/>
						</p:selectOneMenu>
                        </f:facet>
                        
                        <p:ajax event="cellEdit"  listener="#{logformBean.onCellEditRcdSum}" update="msg" />	
                        
                         <p:column headerText="" width="15" exportable="false">
            				 	<p:commandLink title="Print" target="_blank" action="#{logformBean.printRCDSum(rn)}" ajax="false" immediate="false">
            				 			<i class="pi pi-print" style="font-size: 2rem;float: left"></i>
								</p:commandLink>
						 </p:column> 
						 
						 <p:column headerText="" width="15" exportable="false">
            					<p:commandButton icon="pi pi-trash" title="Delete" actionListener="#{logformBean.deleteRCDSum(rn)}" update="formDataSum msg">
            						<p:confirm header="Confirmation" message="Are you sure you want to delete this data?" icon="ui-icon-alert" />
            					</p:commandButton>
            			 </p:column>
                         
            			 <p:column headerText="Date" width="50" >
	            			<p:cellEditor>
							<f:facet name="output"><p:outputLabel value="#{rn.dateTrans}"/></f:facet>
							<f:facet name="input">
								<p:inputText  value="#{rn.dateTrans}"/>
							</f:facet>
							</p:cellEditor>
						</p:column>
						
						<p:column headerText="Series" width="50" >
	            			<p:cellEditor>
							<f:facet name="output"><p:outputLabel value="#{rn.controlNumber}"/></f:facet>
							<f:facet name="input">
								<p:inputText  value="#{rn.controlNumber}"/>
							</f:facet>
							</p:cellEditor>
						</p:column>
            			 
            			 <p:column headerText="Fund" width="70" >
            						<p:outputLabel value="#{rn.fundName}"/>
            			 </p:column>
                         
            			 <p:column headerText="Amount" width="70" >
            				<p:cellEditor>
							<f:facet name="output">
            						<p:outputLabel value="#{rn.amount}">
            							<f:convertNumber currencySymbol="" type="currency"/>
            						</p:outputLabel>
            				</f:facet>
            				<f:facet name="input">
								<p:inputNumber  value="#{rn.amount}"/>
							</f:facet>
							</p:cellEditor>
            			 </p:column>
                         
                      
        </p:dataTable>
	
	</p:dialog>
	
	<p:dialog widgetVar="dlgPrint" closeOnEscape="true">
		<p:panelGrid id="idPrintDate" columns="1" layout="grid">
			<p:selectBooleanCheckbox value="#{logformBean.useModifiedDate}" itemLabel="Use below date">
				<p:ajax event="change" listener="#{logformBean.changeBehaviorCalendarDatePrint}" update="idPrintCal"/>
			</p:selectBooleanCheckbox>
			<p:outputLabel value="Date Printed" />
			<p:calendar id="idPrintCal" value="#{logformBean.perReportDate}" pattern="yyyy-MM-dd" effect="slideDown" inputStyle="width: 7em" disabled="#{logformBean.enableCalendarPrint}"/>
			<p:commandLink id="printId" value="OLD RCD Format" title="Old RCD" target="_blank" actionListener="#{logformBean.printChange('0')}" ajax="false" immediate="false">
            		<i class="pi pi-file-pdf" style="font-size: 2rem;float: left"></i>
			</p:commandLink>
			<p:commandLink id="printId1" value="BLGF RCD Page 1" title="RCD Front" target="_blank" actionListener="#{logformBean.printChange('1')}" ajax="false" immediate="false">
            		<i class="pi pi-file-pdf" style="font-size: 2rem;float: left"></i>
			</p:commandLink>
			<p:commandLink id="printId2" value="BLGF RCD Page 2" title="RCD Back" target="_blank" actionListener="#{logformBean.printChange('2')}" ajax="false" immediate="false">
            		<i class="pi pi-file-pdf" style="font-size: 2rem;float: left"></i>
			</p:commandLink>
		</p:panelGrid>
	</p:dialog>
	
	<p:dialog widgetVar="dlgCSeries" showHeader="false" width="1200" height="850" position="center top" closeOnEscape="true">
		
			<p:toolbar id="tblFrm">
			
			
			
    		<f:facet name="left">
    				<span class="ui-input-icon-left">
				        <i class="pi pi-search" />
				        <p:inputText id="idSearchSeries" value="#{logformBean.searchSeries}" placeholder="Search Series">
				        	<p:ajax event="keyup" listener="#{logformBean.loadSearchSeries}" delay="800" update="dataSeries dataIssued idAvail"/>
				        </p:inputText>
				    </span>
    				
    		</f:facet>
    		<f:facet name="right">
    			<p:commandButton oncomplete="PF('dlgCSeries').hide()" value="Close"/>
    		</f:facet>
			</p:toolbar>
			
			<p:dataTable id="dataSeries" value="#{logformBean.issuedForms}" var="rpt" paginatorAlwaysVisible="false" paginatorPosition="top" rowKey="#{rpt.id}" editable="true"  editMode="cell">
				
				<p:ajax event="cellEdit"  listener="#{logformBean.onCellEditSeries}" update="msg" />	
				
				<p:column headerText="Edit" width="20">
            		<p:commandButton icon="pi pi-pencil" update="dataIssued idAvail" actionListener="#{logformBean.loadIssuedSeries(rpt)}"/>
            	</p:column>
            	
            	<p:column headerText="Stab#" width="20">
            		<p:outputLabel value="#{rpt.stabNo}"/>
            	</p:column>
				
				<p:column headerText="Status" width="50">
					<p:cellEditor>
						<f:facet name="output"><p:outputLabel value="#{rpt.statusName}"/></f:facet>
						<f:facet name="input">
							<p:selectOneMenu value="#{rpt.status}" style="width: 12em">
									<f:selectItems value="#{rpt.formStatus}"/>
							</p:selectOneMenu>
						</f:facet>
					</p:cellEditor>
				
				
            		
            	</p:column>
				
				<p:column headerText="Issued" width="50">
            		<p:outputLabel value="#{rpt.issuedDate}"/>
            	</p:column>
            	
            	<p:column headerText="Qty" width="20">
            		<p:outputLabel value="#{rpt.pcs}"/>
            	</p:column>
            	
            	<p:column headerText="Form" width="70">
            		<p:outputLabel value="#{rpt.formTypeName}"/>
            	</p:column>
            	
            	<p:column headerText="Collector" width="100">
            		<p:outputLabel value="#{rpt.collector.name}"/>
            	</p:column>
				
				<p:column headerText="Old Series" width="50">
            		<p:outputLabel value="#{rpt.beginningNo}"/>
            	</p:column>
            	
            	<p:column headerText="Input New Series" width="50">
		              <p:cellEditor>
		              	  <f:facet name="output"><h:outputText value="#{rpt.newSeries}" /></f:facet>
		                  <f:facet name="input">
		                  <p:inputNumber  placeholder="00000000" value="#{rpt.newSeries}"/>
		                  </f:facet>
		              </p:cellEditor>
		       </p:column>
            	
            	
            	<p:column headerText="Save/View New Series" width="70">
            		<p:commandButton icon="pi pi-save" update="fixDataIssued idNot msg" actionListener="#{logformBean.loadFixIssuedSeries(rpt)}"/>
            	</p:column>
				
				
			</p:dataTable>
			<p:spacer/><p:spacer/>
			<div id="issuedId" style="display: none">
			<p:dataTable id="dataIssued" value="#{logformBean.issuedSeries}" var="rt" paginatorAlwaysVisible="false" paginatorPosition="top" rowKey="#{rt.id}" editable="true"  editMode="cell">
				
				<p:ajax event="cellEdit"  listener="#{logformBean.onCellIssued}" update="dataIssued" />	
				
				<p:columnGroup type="header">
					<p:row>
						<p:column rowspan="2" headerText="Rpt#"/>
						<p:column rowspan="2" headerText="Reported"/>
						<p:column colspan="3" headerText="Series"/>
						<p:column rowspan="2" headerText="Amount" />
						<p:column rowspan="2" headerText="View Changes" />
					</p:row>
					<p:row>
	                    <p:column colspan="1" headerText="Issued Qty" />
	                    <p:column colspan="1" headerText="From" />
	                    <p:column colspan="1" headerText="To" />
                	</p:row>
				</p:columnGroup>
				
				<p:column width="10">
					<p:cellEditor>
						<f:facet name="output">
							<p:outputLabel value="#{rt.rptGroup}"/>
						</f:facet>
						 <f:facet name="input">
		                  	<p:inputNumber  placeholder="00" value="#{rt.rptGroup}"/>
		                  </f:facet>
					</p:cellEditor>
				</p:column>
				
				<p:column width="30">
					<p:cellEditor>
            			 <f:facet name="output">
		            		<p:outputLabel value="#{rt.receivedDate}"/>
	            		</f:facet>
	            		<f:facet name="input">
	            			<p:inputText  value="#{rt.receivedDate}"/>
	            		</f:facet>
            		</p:cellEditor>
				</p:column>
				
            	<p:column width="10">
            	<p:cellEditor>
		              	  <f:facet name="output"><h:outputText value="#{rt.pcs}" /></f:facet>
		                  <f:facet name="input">
		                  <p:inputNumber  placeholder="00000000" value="#{rt.pcs}"/>
		                  </f:facet>
		              </p:cellEditor>
            	</p:column>
            	<p:column width="50">
            		<p:cellEditor>
            			 <f:facet name="output">
		            		<p:outputLabel value="#{rt.beginningNo}"/>
	            		</f:facet>
	            		<f:facet name="input">
	            			<p:inputText  value="#{rt.beginningNo}"/>
	            		</f:facet>
            		</p:cellEditor>
            	</p:column>
            	<p:column width="50">
            		<p:cellEditor>
            			 <f:facet name="output">
		            		<p:outputLabel value="#{rt.endingNo}"/>
	            		</f:facet>
	            		<f:facet name="input">
	            			<p:inputText  value="#{rt.endingNo}"/>
	            		</f:facet>
            		</p:cellEditor>
            	</p:column>
            	<p:column width="70" style="text-align: right; font-weight: bold;">
            		<p:cellEditor>
            			 <f:facet name="output">
		            		<p:outputLabel value="#{rt.amount}">
		            			<f:convertNumber currencySymbol="" type="currency" />
		            		</p:outputLabel>
	            		</f:facet>
	            		<f:facet name="input">
	            			<p:inputNumber  value="#{rt.amount}"/>
	            		</f:facet>
            		</p:cellEditor>
            	</p:column>
            	<p:column width="10">
            		<p:commandButton update="dataIssued msg" icon="pi pi-save" action="#{logformBean.updateSeriesInfo(rt)}">
	    				<p:confirm type="popup" header="Confirmation" message="Are you sure you want to update this issued form series?" icon="pi pi-info-circle" />
	    			</p:commandButton>
            	</p:column>
			</p:dataTable>
			<p:outputLabel id="idAvail" value="#{logformBean.availableSeries}" style="font-weight: bold; font-size: 2em"/>
			</div>
			
			<p:spacer/><p:spacer/>
			<div id="fixId" style="display: none">
			<p:outputLabel id="idNot" value="#{logformBean.changesNumbers}" style="font-weight: bold; font-size: 2em"/>
			<p:dataTable id="fixDataIssued" value="#{logformBean.fixIssuedSeries}" var="ft" paginatorAlwaysVisible="false" paginatorPosition="top">
				
				<p:columnGroup type="header">
					<p:row>
						<p:column rowspan="2" headerText="Rpt#"/>
						<p:column rowspan="2" headerText="Reported" />
						<p:column colspan="3" headerText="Series"/>
						<p:column rowspan="2" headerText="Amount"  />
					</p:row>
					<p:row>
	                    <p:column colspan="1" headerText="Issued Qty" />
	                    <p:column colspan="1" headerText="From" />
	                    <p:column colspan="1" headerText="To" />
                	</p:row>
				</p:columnGroup>
				
				<p:column width="10">
            		<p:outputLabel value="#{ft.rptGroup}"/>
            	</p:column>
				<p:column width="50">
            		<p:outputLabel value="#{ft.receivedDate}"/>
            	</p:column>
            	
            	<p:column width="10">
            		<p:outputLabel value="#{ft.pcs}"/>
            	</p:column>
            	<p:column width="50">
            		<p:outputLabel value="#{ft.beginningNo}"/>
            	</p:column>
            	<p:column width="50">
            		<p:outputLabel value="#{ft.endingNo}"/>
            	</p:column>
            	<p:column width="50" style="text-align: right; font-weight: bold;">
            		<p:outputLabel value="#{ft.amount}">
            			<f:convertNumber currencySymbol="" type="currency" />
            		</p:outputLabel>
            	</p:column>
			</p:dataTable>
			
			<p:toolbar id="tblSeriesSave">
    		<f:facet name="left"/>
	    		<f:facet name="right">
	    			<p:outputLabel value="If you are ok with the series click here to save the changes" />
	    			<p:commandButton update="dataSeries dataIssued fixDataIssued idSearchSeries msg" icon="pi pi-save" action="#{logformBean.saveChangeSeries}">
	    				<p:confirm type="popup" header="Confirmation" message="Are you sure you want to change on the series?" icon="pi pi-info-circle" />
	    			</p:commandButton>
	    		</f:facet>
			</p:toolbar>
			
				
			
			</div>
	</p:dialog>
	
	<p:dialog widgetVar="dlgCash" width="500" position="center center" height="510" header="Cash Ticket Details" closeOnEscape="true" closable="false">
		<p:toolbar id="tbCash">
    		<f:facet name="left"/>
    			
    		<f:facet name="right">
    				<p:commandButton value="Save" actionListener="#{logformBean.saveData}" icon="pi pi-save" update="gridId listForm reportData colMapId fundSerId msg" oncomplete="PF('dlgCash').hide()"/>
    				<p:commandButton value="Close" onclick="PF('dlgCash').hide()" icon="pi pi-times"/>
    		</f:facet>
			</p:toolbar> 
		<p:panelGrid id="ctDtlsId" layout="grid" columns="2">
			<p:inputText value="#{logformBean.pujLabel}"/>
			<p:inputText value="#{logformBean.puj}" placeholder="00.00">
				<p:ajax event="change" listener="#{logformBean.calculateCashTicket}" update="totalCashId"/>
			</p:inputText>
			
			<p:inputText value="#{logformBean.peddlerLabel}"/>
			<p:inputText value="#{logformBean.pedller}" placeholder="00.00">
				<p:ajax event="change" listener="#{logformBean.calculateCashTicket}" update="totalCashId"/>
			</p:inputText>
			
			<p:inputText value="#{logformBean.isdaLabel}"/>
			<p:inputText value="#{logformBean.isda}" placeholder="00.00">
				<p:ajax event="change" listener="#{logformBean.calculateCashTicket}" update="totalCashId"/>
			</p:inputText>
			
			<p:inputText value="#{logformBean.skylabLabel}"/>
			<p:inputText value="#{logformBean.skylab}" placeholder="00.00">
				<p:ajax event="change" listener="#{logformBean.calculateCashTicket}" update="totalCashId"/>
			</p:inputText>
			
			<p:inputText value="#{logformBean.marketLablel}"/>
			<p:inputText value="#{logformBean.market}" placeholder="00.00">
				<p:ajax event="change" listener="#{logformBean.calculateCashTicket}" update="totalCashId"/>
			</p:inputText>
			
			<p:outputLabel value="Total"/>
			<p:outputLabel id="totalCashId" value="#{logformBean.totalCashTicket}"/>
		</p:panelGrid>
		
	</p:dialog>
	
	<p:dialog widgetVar="dlgPerForms" width="1000" position="center top" height="700" header="Forms Details Collection" closeOnEscape="true" closable="false">
		<p:toolbar id="tbFormPer">
    		<f:facet name="left">
    				<div class="ui-inputgroup">
    				<p:selectOneMenu id="frmColFormId" value="#{logformBean.collectorIdSearch}" style="width: 12em" filter="true" filterMatchMode="contains">
						<f:selectItems value="#{logformBean.collectorSearch}"/>
						<p:ajax event="change" listener="#{logformBean.loadForms}" update="formData" />
					</p:selectOneMenu>
    				<p:selectOneMenu id="frmFormId" value="#{logformBean.formTypeIdSearch}" style="width: 12em" filter="true" filterMatchMode="contains">
						<f:selectItems value="#{logformBean.formTypesSearch}"/>
						<p:ajax event="change" listener="#{logformBean.loadForms}" update="formData" />
					</p:selectOneMenu>
    				<p:calendar value="#{logformBean.fromFormDate}" pattern="yyyy-MM-dd" effect="slideDown" disabledWeekends="true" inputStyle="width: 12em">
    					<p:ajax event="dateSelect" listener="#{logformBean.loadForms}" update="formData" />
    				</p:calendar>
    				<p:calendar value="#{logformBean.toFormDate}" pattern="yyyy-MM-dd" effect="slideDown" disabledWeekends="true" inputStyle="width: 12em">
    					<p:ajax event="dateSelect" listener="#{logformBean.loadForms}" update="formData" />
    				</p:calendar>
    				</div>
			</f:facet>		
    		<f:facet name="right">
    				<p:commandButton value="Close" onclick="PF('dlgPerForms').hide()"/>
    		</f:facet>
		</p:toolbar> 
		
		<p:dataTable id="formData" value="#{logformBean.formsInfo}" var="fm" stickyHeader="false"
							rows="5" paginator="true" paginatorTemplate="{Exporters} {CurrentPageReport} {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                         rowsPerPageTemplate="5,10,20,30,40,50,100" lazy="false"
                         scrollable="true" paginatorPosition="top" paginatorAlwaysVisible="true">
                         
                         <f:facet name="{Exporters}">
                       				<div class="ui-inputgroup">
                         			<p:menuButton id="exeForm" value="Exports" style="float: left">
										<p:menuitem value="Download Excel" ajax="false" immediate="true" icon="pi pi-file-excel" target="_blank">
											<p:dataExporter type="xls" target="formData" fileName="formdata" pageOnly="false"/>
										</p:menuitem>
									</p:menuButton> 
									</div>
            				</f:facet>
                         
                         
                         <p:columnGroup type="header">
								<p:row>
									<p:column rowspan="2" headerText="Date Reported" width="100"/>
									<p:column rowspan="2" headerText="Collector" width="100"/>
									<p:column colspan="4" headerText="Series" width="300"/>
									<p:column rowspan="2" headerText="Amount" width="100"/>
								</p:row>
								<p:row>
									<p:column colspan="1" headerText="Form" width="150"/>
				                    <p:column colspan="1" headerText="From" width="50"/>
				                    <p:column colspan="1" headerText="To"  width="50"/>
				                     <p:column colspan="1" headerText="Qty" width="50"/>
			                	</p:row>
							</p:columnGroup>
							
							
                         
                         
                         <p:column>
            						<p:outputLabel value="#{fm.receivedDate}"/>
            			 </p:column>
            			 
            			 <p:column >
            						<p:outputLabel value="#{fm.collector.name}"/>
            			 </p:column>
                         
                         <p:column>
            					<p:outputLabel value="#{fm.formTypeName}"/>
            			 </p:column>
            			 
            			 <p:column>
            						<p:outputLabel value="#{fm.beginningNo}"/>
            			 </p:column>
            			 
            			 <p:column>
            						<p:outputLabel value="#{fm.endingNo}"/>
            			 </p:column>
            			 
            			 <p:column>
            						<p:outputLabel value="#{fm.pcs}"/>
            			 </p:column>
            			 
            			 <p:column>
            						<p:outputLabel value="#{fm.amount}">
            							<f:convertNumber currencySymbol="" type="currency"/>
            						</p:outputLabel>
            			 </p:column>
                         
                      <p:columnGroup type="footer">
						<p:row>
							<p:column colspan="2" headerText="amoun"/>
							<p:column rowspan="1" headerText="#{logformBean.totalAmountPerForms}"/>
							
						</p:row>
					</p:columnGroup>   
					
					<f:facet name="header">
			            <span class="p-text-bold" style="font-size: 2em">Total: #{logformBean.totalAmountPerForms}</span>
			        </f:facet>
        </p:dataTable>                 
		
	</p:dialog>
	
	<p:commandButton title="Graph" icon="pi pi-chart-pie"  actionListener="#{graphIssuanceBean.loadGraph}" update="graphLineId graphBardId" style="-moz-border-radius: 100px;-webkit-border-radius: 100px;border-radius: 100px;height: 30px;width: 30px;bottom: 30px;right: 7px;float:right; position: fixed;z-index: 1500;font-size: 70% ! important;font-weight: bold ! important;  text-transform: none ! important; "/>
	<ui:include src="bankdeposit.xhtml" />
	<ui:include src="graphissuance.xhtml" />
	<ui:include src="formchange.xhtml" />
	<ui:include src="loader.xhtml" />
	<ui:include src="menu.xhtml" /> 	
	<ui:include src="ctmovement.xhtml" /> 
	<script>
		//part of formchange.xhtml
     	function buttonClick(){
     		$( "#updateId" ).trigger( "click" );
     	}
     </script>
</h:form>
</h:body>
</html>	
	
	
	
	
	
	
	
	
	
	
	
	
	